<p id="notice"><%= notice %></p>
<div class="show_photo">
  <table>
    <tr>
      <td>
        <div id="prev">
          <% if !@prev.nil? %>
            <%= link_to(image_tag(@prev.image.url(:thumbnail), :border => 0, :title => "Previous photo"), {:action => :show, :id => @prev}, {:remote => true, :id => 'prevLink'}) %>
          <% end %>
        </div>
      </td>
      <td>
        <div id="photo">
          <%= link_to(image_tag(@media.image.url(:medium), :border => 0, :title => @media.display_tags, :id => "display_photo_#{@media.id}"), @media.image.url) %><br/>
        </div>
      </td>
      <td>
        <div id="next">
          <% if !@next.nil? %>
            <%= link_to(image_tag(@next.image.url(:thumbnail), :border => 0, :title => "Next photo"), {:action => :show, :id => @next}, {:remote => true, :id => 'nextLink'}) %>
          <% end %>
        </div>
      </td>
    </tr>
  </table>
</div>
<div id="footer">
  <div id="display_tags"><%= @media.display_tags %></div>
  <%= @media.taken_at.strftime('%Y-%m-%d %H:%M:%S (%a)') %><br/>
  <%= link_to "Slideshow", :action => :slideshow, :id => @media.id %>
  <%= link_to "Edit", :action => :edit, :id => @media.id %>
</div>
<div id="stars"></div>

<script type="text/javascript">
  $(function() {
      $('#stars').raty({
        half: true,
        path: "/images/",
        <% unless @media.stars.nil? %>
          start: <%= @media.stars %>,
        <% end %>
        click: function(score) {
          $.get("/media/<%=@media.id%>/stars", {stars: score});
          }
        });

      $('#display_tags').editable("/media/<%= @media.id %>/update_tags",
        { tooltip: 'Click to edit..',
          type: 'autocomplete',
          onblur: "submit",
          callback: function(value, settings) {
            $.get("/media/<%=@media.id%>/update_tag_display", {
              old_tags: $("#display_photo_<%=@media.id%>").attr('title')
              });
          },
          autocomplete: {
            minLength: 2,
            source: "/tags/complete_tag",
            focus: function() {
              return false;
            },
            select: selectTag
          }
        });
    });
  
</script>
